---
title: '**Dispersion Optimization in Practice**'
author: "Trevor Kapuvari, Nohman Akhtari"
date: "03/20/2024"
output:
  html_document:
    keep_md: yes
    toc: yes
    theme: lumen
    toc_float: yes
    code_folding: hide
    number_sections: no
    css: style.css
  pdf_document:
    toc: yes
---
```{r setup, results = 'hide', message = FALSE, warning = FALSE, error = FALSE}
library(tidyverse)
library(tidycensus)
library(sf)
library(knitr)
library(viridis)
library(bookdown)
library(MASS)
library(rmarkdown)
options(scipen = 999)
knitr::opts_chunk$set(echo = TRUE)
theme_update(plot.title = element_text(hjust = 0.5))
```


Where would the residence of sex offenders be if
the city was to accept 2, 4, 6 and 8 offenders
(changing the p-value)?
b. Prepare a map that would indicate those locations
(Which residences are selected)?
c. Are some residences more likely to be selected
and why?
3
d. How does the objective function value changes
with a different value for p (graph it)?
e. Report on the running time as well â€“ IT CAN TAKE
A LONG TIME!
2. The city council is likely to propose two additional
scenarios:
a. Using p=2, where would those residences be in
case city council would impose a 500meters ban
from school and 500meters from any park?
b. Using p=2, where would those residences be in
case city council would impose a 750meters ban
from school and 250meters from any park?
c. Prepare a map that would show the locations for
both a) and b) and comment on the difference.


# Introduction
The p-dispersion problem is a technique to maximize the minimum distance between the two closest pair of facilities in a network. Even though this might sound not productive at first glance, there are quite a few evident use cases for p-dispersion optimization problems. Think of facilities that can pose a threat to each other, like in some chemical factories- the gases and other byproducts might be hazardous, could interact, and therefore, are best located far from each other. For a more tangible business case, take a savvy entrepreneur who wants to open a service business- where should he best open his shop? It only makes sense to avoid competition, and therefore, maximize the minimum distance between his stores or to those of the competition.

In this assignment, we will take the p-dispersion problem to a real-world policy issue facing municipalities. Imagine a situation in which former sex-offenders have fulfilled their prison time and now have to be reintegrated to society. How can we best locate them within a municipality to both guarantee safety for current inhabitants but also allow resocialization of former prisoners. This is a handy case for the optimization problem described above, but with a twist: The constraints should, in addition to the standard p-dispersion problem, include a minimum distance from schools or other facilities that could potentially be locations or lead to crimes by former sex-offender convicts. Additionally, we want the offenders to be as far away from each other as possible

In this assignment, we will take the example of Moscow, Idaho to discover how slight changes in parameters change the siting outcome. 


# Methodology
For the purpose of this assignment, we will employ the p-dispersion maximization problem that maximizes the minimum distance between any pair of facilities at two locations. As this formulation seems a bit unintuitive, we will first introduce the mathematical formulation and then explain each term in the optimization problem. 


$$
\text{max } Z\\
\text{s.t. } Z - m (2-X_i-X_j) \leq d_{ij}\\
\sum_{i} X_i = p \\ 
X_id'_{ik} \leq b\\
X_i \in \{0,1\}\\
Z \geq 0
$$
where $Z$ is the minimum distance between two facilities,$d_{ij}$ is the distance between locations $i$ and $j,$ $p$ is the number of facilities to be sited, and $m$ is a large number that is used to establish what is called an upper effective bound on $Z$. Note that if facilities at both site $i$ and $j$ are chosen, we are left with $Z \leq d_{ij}$ implying that we must chose $d_{ij}$ as distance. The upper bound on $Z$ only comes into action if none or either locations are chosen, giving us $Z \leq d_{ij}+2m$ or $Z \leq d_{ij}+m,$ respectively.

Note that for each placed facility, the constraints also include a minimum distance $b$ that the sited facility must be away from. The index $k$ is the location index for facilities for which we want to build up the distance.

Further, it has to be clarified that the notion of distance has to be thought of in an abstract way in the sense that it could be pure walking distance, but also aerial distance or time to get to a specified location. The choice of the distance variable is eventually up to the person who builds the model, but should be adjusted specifically to each use case to make the results more robust.

# Code
Trevor
# Results
Trevor

```{r Map 1}
knitr::include_graphics("https://raw.githubusercontent.com/TrevorKap/Classes_MUSA/main/SpatialOptimization/Homework5Map1.png")

```



```{r Map 2}
knitr::include_graphics("https://raw.githubusercontent.com/TrevorKap/Classes_MUSA/main/SpatialOptimization/Homework5Map2.png")

```


# Conclusion
First, we have to note that the ideal locations of offenders might satisfy all of our constraints in the maximization problem, but do not necessarily represent a feasible solution because they ignore the current socioeconomic ecosystem of the ideal locations.. The idea behind this thought is that offenders could, for example, be situated into areas with high crime and therefore be stimulated to recidivate. (to be continued)

